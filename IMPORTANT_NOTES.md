# 重要注意事项

## 🚨 开发注意事项

### 环境配置
- **Node.js 版本**: 必须使用 v22.10.0 或更高版本
- **包管理器**: 推荐使用 npm，避免混用 yarn 和 npm
- **操作系统**: 支持 macOS、Windows、Linux，但某些功能可能有平台差异

### 开发流程
1. **首次启动前**:
   ```bash
   # 确保使用正确的 Node.js 版本
   nvm use v22.10.0
   
   # 清理可能存在的缓存
   npm cache clean --force
   
   # 安装依赖
   npm install
   ```

2. **开发模式启动**:
   ```bash
   # 标准启动
   npm run electron:dev
   
   # 指定端口启动（避免端口冲突）
   npm run dev:port -- --port 3005
   ```

3. **调试模式**:
   - 开发者工具默认关闭，通过设置菜单开启
   - 生产环境请确保关闭开发者工具
   - 使用内置日志系统而非浏览器控制台

## 🔧 构建和部署

### 构建前准备
```bash
# 清理之前的构建文件
rm -rf dist
rm -rf release
rm -rf node_modules/.cache

# 重新安装依赖（确保依赖完整性）
npm install

# 验证依赖
npm audit
```

### 平台特定注意事项

#### macOS
- **图标文件**: `src/assets/electron.icns` 必须是有效的 macOS 图标格式
- **代码签名**: 生产环境需要配置开发者证书
- **公证**: App Store 分发需要通过苹果公证

#### Windows
- **图标格式**: 需要 `.ico` 格式图标文件
- **安装包**: 支持 NSIS 和 Squirrel 安装程序
- **权限**: 某些功能可能需要管理员权限

#### Linux
- **依赖**: 确保系统安装了必要的多媒体库
- **AppImage**: 推荐使用 AppImage 格式分发
- **桌面集成**: 需要正确配置 .desktop 文件

## 📺 播放源相关

### 支持的格式
- **M3U**: 标准播放列表格式
- **M3U8**: HLS 流媒体格式
- **直播流**: 支持 HTTP/HTTPS 协议的直播流

### 播放源质量要求
1. **网络稳定性**: 播放源服务器应具备良好的网络连接
2. **编码格式**: 推荐使用 H.264 视频编码和 AAC 音频编码
3. **分辨率**: 支持从 240p 到 4K 的各种分辨率

### 常见播放问题及解决方案

#### 播放失败
- **检查网络**: 确认播放源地址可访问
- **协议问题**: HTTPS 页面无法播放 HTTP 流，需要使用代理
- **编码不支持**: 某些特殊编码格式可能不被支持

#### 卡顿或延迟
- **缓冲设置**: 调整播放器缓冲区大小
- **网络带宽**: 确保网络带宽足够
- **服务器负载**: 播放源服务器可能过载

## 🔒 安全注意事项

### 网络安全
- **HTTPS 优先**: 尽量使用 HTTPS 协议的播放源
- **跨域处理**: 应用内置了 CORS 处理机制
- **代理服务**: 内置代理服务器处理跨域问题

### 数据安全
- **本地存储**: 播放列表数据存储在本地，不会上传到服务器
- **隐私保护**: 不收集用户个人信息
- **播放记录**: 播放历史仅保存在本地

## ⚡ 性能优化

### 内存管理
- **虚拟滚动**: 大型播放列表自动启用虚拟滚动
- **播放器清理**: 切换频道时自动清理之前的播放器实例
- **缓存控制**: 合理控制视频缓存大小

### 启动优化
- **预加载**: 关键资源预加载
- **懒加载**: 非关键组件懒加载
- **代码分割**: 按需加载减少初始包大小

## 🐛 故障排除

### 常见错误及解决方案

#### "Module not found" 错误
```bash
# 清理并重新安装依赖
rm -rf node_modules
rm package-lock.json
npm install
```

#### 端口占用错误
```bash
# 查找占用端口的进程
lsof -i :3000

# 杀死占用进程
kill -9 <PID>

# 或使用不同端口
npm run dev:port -- --port 3005
```

#### 播放器初始化失败
1. 检查浏览器是否支持 MSE (Media Source Extensions)
2. 确认播放源格式正确
3. 查看开发者工具控制台错误信息

### 日志分析
- **启用详细日志**: 通过设置菜单开启详细日志
- **日志文件位置**: 
  - macOS: `~/Library/Application Support/iptv-player/app.log`
  - Windows: `%APPDATA%/iptv-player/app.log`
  - Linux: `~/.config/iptv-player/app.log`

## 📋 最佳实践

### 开发建议
1. **代码规范**: 遵循 ESLint 和 Prettier 配置
2. **组件设计**: 保持组件单一职责原则
3. **状态管理**: 合理使用 Vue 3 Composition API
4. **错误处理**: 完善的错误捕获和用户提示

### 用户体验
1. **加载提示**: 为耗时操作提供加载指示
2. **错误反馈**: 清晰的错误信息和解决建议
3. **响应式设计**: 适配不同屏幕尺寸
4. **键盘快捷键**: 提供常用操作的快捷键

### 维护建议
1. **定期更新**: 及时更新依赖包版本
2. **安全扫描**: 定期进行安全漏洞扫描
3. **性能监控**: 监控应用性能指标
4. **用户反馈**: 收集并处理用户反馈

## 🔄 版本更新

### 更新流程
1. **备份数据**: 更新前备份播放列表数据
2. **清理缓存**: 清理旧版本缓存文件
3. **重新安装**: 完全重新安装新版本
4. **数据迁移**: 必要时进行数据格式迁移

### 兼容性
- **向后兼容**: 新版本尽量保持向后兼容
- **数据格式**: 播放列表数据格式保持稳定
- **API 变更**: 重大 API 变更会提前通知

---

**⚠️ 重要提醒**: 在生产环境部署前，请务必进行充分的测试，确保所有功能正常工作。
